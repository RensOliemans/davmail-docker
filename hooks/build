#!/bin/sh

echo "------ HOOK START - BUILD -------"
BA=

# Build headless: no junit tests, graphics support and winrun and such
BA="${BA} --build-arg EXCLUDE_DEPS=junit;libgrowl;servlet-api;swt;winrun4j"

echo "${DOCKER_TAG}" | grep '^trunk' && BA="${BA} --build-arg DAVMAIL_REV=HEAD"
echo "${DOCKER_TAG}" | grep 'tiny$'  && BA="${BA} --build-arg BASE_IMAGE=kran0/tiny:openjdk8-jre"

docker build ${BA} -t ${IMAGE_NAME} .

echo "------ HOOK END - BUILD -------"
